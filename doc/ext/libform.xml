<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- %% -->
<!-- %W  libform.tex              GAP documentation           Alexander Hulpke -->
<!-- %% -->
<!-- %H  @(#)<M>Id: libform.tex,v 4.14 2004/01/27 09:26:53 stefan Exp </M> -->
<!-- %% -->

<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<Chapter Label="Library Files">
<Heading>Library Files</Heading>

This chapter describes some of the conventions used in the &GAP;
library files.
These conventions are intended as a help on how to read library files and
how to find information in them.
So everybody is recommended to follow these conventions,
although they do not prescribe a compulsory programming style
-- &GAP; itself will not bother with the formatting of files.
<P/>
Filenames have traditionally &GAP; adhered to the 8+3 convention (to make it
possible to use the same filenames even on a MS-DOS file system) and been in
lower case (systems that do not recognize lower case in file names will
convert them automatically to upper case). It is no longer so important to 
adhere to these conventions, but at the very least filenames should adhere
to a 16+5 convention, and be distinct even after identifying upper and lower
case. Directory names of packages, however, <E>must</E> be in lower case
(the <Ref Func="LoadPackage"/> command assumes this).


<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<Section Label="File Types">
<Heading>File Types</Heading>

The &GAP; library consists of the following types of files, distinguished
by their suffixes:
<P/>
<List>
<Mark><C>.g</C> </Mark>
<Item>
    Files which contain parts of the <Q>inner workings</Q> of &GAP;.
    These files usually do not contain mathematical functionality,
    except for providing links to kernel functions.
</Item>
<Mark><C>.gd</C> </Mark>
<Item>
    Declaration files.
    These files contain declarations of all categories, attributes,
    operations, and global functions.
    These files also contain the operation definitions in comments.
</Item>
<Mark><C>.gi</C> </Mark>
<Item>
    Implementation files.
    These files contain all installations of methods and global functions.
    Usually declarations of representations are also considered to be
    part of the implementation and are therefore found in the <C>.gi</C> files.
</Item>
<Mark><C>.co</C> </Mark>
<Item>
    Completion files.
    They are used only to speed up loading
    (see&nbsp;<Ref Sect="Completion Files"/>).
</Item>
</List>
<P/>
As a rule of thumb, all <C>.gd</C> files are read in before the <C>.gi</C>
files are read.
Therefore a <C>.gi</C> file usually may use any operation or global function
(it has been declared before),
and no care has to be taken towards the order in which the <C>.gi</C> files
are read.

</Section>


<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<Section Label="File Structure">
<Heading>File Structure</Heading>

Every file starts with a header that lists the filename, copyright, a short
description of the file contents and the original authors of this file.
<P/>
This is followed by a revision entry:
<Log><![CDATA[
Revision.file_suf :=
    "@(#)$Id: libform.xml,v 4.4 2008/09/18 07:58:06 gap Exp $";
]]></Log>
where <F>file.suf</F> is the file name. The revision control system used for the
development will automatically append text to the string <Q><C>Id: </C></Q> which
indicates the version number. The reason for these revision entries is to
give the possibility to check from within &GAP; for revision numbers of a
file. (Do not mistake these revision numbers for the version number of
&GAP; itself.)
<P/>
Global comments usually are indented by two hash marks and two blanks.
Several such comments are actually used for the manuals.
<P/>
In manuals whose format is based on the &TeX; macros described in
the document <Q>The gapmacro.tex Manual Format</Q>,
every declaration or method or function installation which is not only of
local scope is introduced by a function header of the following type.
<P/>
<Log><![CDATA[
#############################################################################
##
#X  ExampleFunction(<A>,<B>)
##
##  This function does nothing.
]]></Log>
<P/>
The <Q>X</Q> in the example is one of the letters: <C>F</C>, <C>A</C>, <C>P</C>, <C>O</C>,
<C>C</C>, <C>R</C> or <C>V</C>, and has the same meaning as at the end
of a declaration line in the Reference Manual (see&nbsp;<Ref Sect="Manual Conventions"/>);
it indicates whether the object declared will be a function, attribute,
property, operation, category, representation or variable, respectively.
Additionally <C>M</C> is used in <C>.gi</C> files for method installations.
The line then gives a sample usage of the function.
This is followed by a comment which describes the identifier.
This description will automatically be extracted to build the
manual source, if there is a <C>\Declaration</C> line in some
<C>.msk</C> file together with an appropriate configuration file.
<P/>
Indentation in functions and the use of decorative spaces in the code are
left to the decision of the authors of each file.
<P/>
The file ends with an 
<P/>
<Log><![CDATA[
#E
]]></Log>
<P/>
comment section.

</Section>


<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<Section Label="Finding Implementations in the Library">
<Heading>Finding Implementations in the Library</Heading>

There is no general browsing tool that would point you to the place in the
library where a certain method or global function is installed. However the
following remarks might be of help:
<P/>
You can use <Ref Sect="ApplicableMethod"/>
to get the function which implements a method for specific
arguments. Setting its print level higher will also give you the
installation string for this method.
<P/>
To find the occurrence of functions and methods in the library, one can use
the <C>grep</C> tool under UNIX. To find a function, search for the function name
in the <C>.gd</C> files (as it is declared only once, only one file will show up),
the function installation is likely to occur in the corresponding <C>.gi</C> file.
<P/>
To find a method search for the string <Q><C>Method(</C></Q>
(this catches both <Ref Func="InstallMethod"/> and
<Ref Func="InstallOtherMethod"/>)
and the installation string or the operation name.

</Section>


<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<Section Label="Undocumented Variables">
<Heading>Undocumented Variables</Heading>

For several global variables in &GAP;,
no information is available via the help system 
(see Section&nbsp;<Ref Sect="Help" BookName="tut"/>,
for a quick overview of the help system,
or Chapter&nbsp;<Ref Chap="The Help System"/>,
for details).
There are various reasons for <Q>hiding</Q> a variable from the user;
namely, the variable may be regarded as of minor importance
(for example, it may be a function called by documented &GAP;
functions that first compute many input parameters for the undocumented
function),
or it belongs to a part of &GAP; that is still experimental in the sense
that the meaning of the variable has not yet been fixed or even that it is
not clear whether the variable will vanish in a more developed version.
<P/>
As a consequence, it is dangerous to use undocumented variables because
they are not guaranteed to exist or to behave the same in future versions
of &GAP;.
<P/>
Conversely, for <E>documented</E> variables, the definitions in the &GAP;
manual can be relied on for future &GAP; versions (unless they turn out
to be erroneous);
if the &GAP; developers find that some piece of minor, but documented
functionality is an insurmountable obstacle to important developments,
they may make the smallest possible incompatible change to the functionality
at the time of a major release.
However, in any such case it will be announced clearly in the &GAP; Forum
what has been changed and why.
<P/>
So on the one hand, the developers of &GAP; want to keep the freedom
of changing undocumented &GAP; code.
On the other hand, users may be interested in using undocumented
variables.
<P/>
In this case, whenever you write &GAP; code involving undocumented
variables,
and want to make sure that this code will work in future versions of &GAP;,
you may ask at <Email>support@gap-system.org</Email> for documentation
about the variables in question.
The &GAP; developers then decide whether these variables shall be
documented or not, and if yes, what the definitions shall be.
<P/>
In the former case, the new documentation is added to the &GAP; manual,
this means that from then on, this definition is protected against
changes.
<P/>
In the latter case (which may occur for example if the variables
in question are still experimental), you may add the current
values of these variables to your private code if you want to
be sure that nothing will be broken later due to changes in &GAP;.

</Section>
</Chapter>


<!-- %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->
<!-- %% -->
<!-- %E -->

